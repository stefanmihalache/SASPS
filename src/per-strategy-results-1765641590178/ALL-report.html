<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ALL Strategies - Load Test Comparison</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; }
    .card { border: 1px solid #e6e6e6; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.06); margin-top: 14px; }
    h1 { font-size: 22px; margin: 0 0 8px; }
    h2 { font-size: 16px; margin: 0 0 10px; }
    .meta { color: #555; font-size: 13px; line-height: 1.5; }
    canvas { width: 100% !important; height: 420px !important; }
    .row { display:flex; gap: 12px; flex-wrap: wrap; margin: 12px 0 0; }
    select { padding: 6px 10px; border-radius: 10px; border: 1px solid #ddd; }
  </style>
</head>
<body>
  <h1>ALL Strategies - Comparison Report</h1>
  <div class="meta" id="meta"></div>

  <div class="row">
    <div>
      <div class="meta">Workload</div>
      <select id="workloadSel"></select>
    </div>
    <div>
      <div class="meta">Metric</div>
      <select id="metricSel">
        <option value="rps">Req/Sec (mean)</option>
        <option value="bps">Bytes/Sec (mean)</option>
        <option value="p95">Latency p95 (ms)</option>
        <option value="p99">Latency p99 (ms)</option>
        <option value="errRate">Error rate (%)</option>
        <option value="hitRate">Cache hit rate (%)</option>
      </select>
    </div>
  </div>

  <div class="card">
    <h2 id="chartTitle">Chart</h2>
    <canvas id="chart"></canvas>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script>
    const PAYLOAD = {"meta":{"runId":1765641590178,"startedAt":"2025-12-13T15:59:50.178Z","host":{"platform":"darwin","node":"v18.20.8","cpuCount":16,"totalMemMB":49152},"config":{"iterations":1,"warmupSec":5,"cooldownMs":800,"concurrency":[10,25,50,100],"durations":{"READ_DURATION":30,"WRITE_DURATION":10,"MIXED_DURATION":30}},"finishedAt":"2025-12-13T16:20:06.767Z"},"aggAll":{"services":["Cache-Aside","No-Caching","Write-Behind","Write-Through"],"workloads":{"mixed":{"conc":[10,25,50,100],"datasets":{"rps":{"Cache-Aside":[7648.67,7309.74,7801.6,7651.07],"No-Caching":[7779.87,7811.6,7419.2,7312.4],"Write-Behind":[7296.67,7557.87,7924.94,7926.94],"Write-Through":[6968.8,7352,7419.87,7346.4]},"bps":{"Cache-Aside":[36110336,35407189.34,36893491.21,36322235.74],"No-Caching":[36799556.27,37496422.4,34945979.74,35158971.74],"Write-Behind":[34594816,35965064.54,38186734.94,37506252.8],"Write-Through":[32987545.6,34745002.67,35054114.14,35357764.27]},"p95":{"Cache-Aside":[null,null,null,null],"No-Caching":[null,null,null,null],"Write-Behind":[null,null,null,null],"Write-Through":[null,null,null,null]},"p99":{"Cache-Aside":[2,8,15,26],"No-Caching":[2,4,9,17],"Write-Behind":[2,7,13,27],"Write-Through":[3,8,16,31]},"errRate":{"Cache-Aside":[0,0,0,0],"No-Caching":[0,0,0,0],"Write-Behind":[0,0,0,0],"Write-Through":[0,0,0,0]},"hitRate":{"Cache-Aside":[53.125898810302,50.71541912891223,50.28769142051643,14.58806781077763],"No-Caching":[0,0,0,0],"Write-Behind":[53.6779065225882,50.99748644000529,50.129614562243376,50.127322693694374],"Write-Through":[53.27167845714532,50.98337912461576,50.12529471202425,50.32037765110806]}}},"read":{"conc":[10,25,50,100],"datasets":{"rps":{"Cache-Aside":[9344.54,8871.87,11121.34,11033.87],"No-Caching":[6536.94,6930.14,6451.6,6374.4],"Write-Behind":[9927.47,10936,10939.2,10935.2],"Write-Through":[10001.34,11088.8,11093.87,11046.94]},"bps":{"Cache-Aside":[70258961.07,67620044.8,83433881.6,82785075.2],"No-Caching":[49186952.54,52542395.74,48391782.4,48413627.74],"Write-Behind":[74483848.54,82363460.27,82282632.54,82892117.34],"Write-Through":[75862289.07,84100164.27,83014451.2,82715170.14]},"p95":{"Cache-Aside":[null,null,null,null],"No-Caching":[null,null,null,null],"Write-Behind":[null,null,null,null],"Write-Through":[null,null,null,null]},"p99":{"Cache-Aside":[2,4,6,12],"No-Caching":[2,5,10,19],"Write-Behind":[2,3,6,11],"Write-Through":[2,3,6,11]},"errRate":{"Cache-Aside":[0,0,0,0],"No-Caching":[0,0,0,0],"Write-Behind":[0,0,0,0],"Write-Through":[0,0,0,0]},"hitRate":{"Cache-Aside":[99.9917953547439,99.99060627125331,99.98081902752469,99.9649657963486],"No-Caching":[0,0,0,0],"Write-Behind":[99.99127045148553,99.99146567831093,99.99238334328577,99.99268613779316],"Write-Through":[99.99333393327933,99.9936872861944,99.9915879034051,99.99064791825677]}}},"write":{"conc":[10,25,50,100],"datasets":{"rps":{"Cache-Aside":[8956,9604.73,10206.91,10488],"No-Caching":[10050.55,10168.37,10154.55,9974.19],"Write-Behind":[7871.82,8646.91,8895.21,9028.8],"Write-Through":[6599.2,7003.6,7068.8,6999.1]},"bps":{"Cache-Aside":[2633076.37,2823540.37,3000785.46,3084492.8],"No-Caching":[2954798.55,2989242.19,2985704.73,2933015.28],"Write-Behind":[2597888,2853143.28,2935398.4,2983936],"Write-Through":[2045644.8,2170880,2191360,2176558.55]},"p95":{"Cache-Aside":[null,null,null,null],"No-Caching":[null,null,null,null],"Write-Behind":[null,null,null,null],"Write-Through":[null,null,null,null]},"p99":{"Cache-Aside":[2,4,7,12],"No-Caching":[2,4,7,13],"Write-Behind":[2,4,7,14],"Write-Through":[2,6,10,17]},"errRate":{"Cache-Aside":[0,0,0,0],"No-Caching":[0,0,0,0],"Write-Behind":[0,0,0,0],"Write-Through":[0,0,0,0]},"hitRate":{"Cache-Aside":[null,null,null,null],"No-Caching":[null,null,null,null],"Write-Behind":[null,null,null,null],"Write-Through":[null,null,null,null]}}}}}};

    const meta = PAYLOAD.meta || {};
    document.getElementById("meta").innerHTML =
      `<div><b>Run:</b> ${meta.startedAt} â†’ ${meta.finishedAt}</div>` +
      `<div><b>Config:</b> iterations=${meta.config.iterations}, warmup=${meta.config.warmupSec}s, conc=[${meta.config.concurrency.join(", ")}]</div>`;

    const workloads = Object.keys(PAYLOAD.aggAll.workloads || {});
    const services = PAYLOAD.aggAll.services || [];

    const workloadSel = document.getElementById("workloadSel");
    const metricSel = document.getElementById("metricSel");

    workloads.forEach(w => {
      const opt = document.createElement("option");
      opt.value = w; opt.textContent = w;
      workloadSel.appendChild(opt);
    });

    function titleFor(metric) {
      if (metric === "rps") return "Req/Sec (mean) vs Concurrency";
      if (metric === "bps") return "Bytes/Sec (mean) vs Concurrency";
      if (metric === "p95") return "Latency p95 (ms) vs Concurrency";
      if (metric === "p99") return "Latency p99 (ms) vs Concurrency";
      if (metric === "errRate") return "Error rate (%) vs Concurrency";
      if (metric === "hitRate") return "Cache hit rate (%) vs Concurrency";
      return "Chart";
    }

    let chart;

    function render() {
      const w = workloadSel.value || workloads[0];
      const metric = metricSel.value;
      document.getElementById("chartTitle").textContent = titleFor(metric);

      const wdata = PAYLOAD.aggAll.workloads[w];
      const labels = wdata.conc;

      const datasets = services.map(svc => ({
        label: svc,
        data: (wdata.datasets[metric] && wdata.datasets[metric][svc]) ? wdata.datasets[metric][svc] : labels.map(_ => null),
      }));

      if (chart) chart.destroy();
      chart = new Chart(document.getElementById("chart"), {
        type: "line",
        data: { labels, datasets },
        options: {
          responsive: true,
          plugins: { legend: { position: "bottom" } },
          scales: {
            x: { title: { display: true, text: "Connections (concurrency)" } },
            y: { title: { display: true, text:
              metric === "rps" ? "Req/Sec" :
              metric === "bps" ? "Bytes/Sec" :
              (metric === "hitRate" || metric === "errRate") ? "%" :
              "ms"
            } }
          }
        }
      });
    }

    workloadSel.addEventListener("change", render);
    metricSel.addEventListener("change", render);
    render();
  </script>
</body>
</html>